/* Generated by Nimrod Compiler v0.9.5 */
/*   (c) 2014 Andreas Rumpf */
/* The generated code is subject to the original license. */
#define NIM_INTBITS 32
#include "nimbase.h"

#include <string.h>

#include <stdio.h>
typedef struct NimStringDesc NimStringDesc;
typedef struct TGenericSeq TGenericSeq;
typedef struct tprocess128402 tprocess128402;
typedef struct TNimObject TNimObject;
typedef struct TNimType TNimType;
typedef struct TNimNode TNimNode;
typedef struct TY129403 TY129403;
typedef struct tcell41688 tcell41688;
typedef struct tcellset41700 tcellset41700;
typedef struct tgcheap43616 tgcheap43616;
typedef struct tcellseq41704 tcellseq41704;
typedef struct tpagedesc41696 tpagedesc41696;
typedef struct tmemregion24010 tmemregion24010;
typedef struct tsmallchunk23238 tsmallchunk23238;
typedef struct tllchunk24004 tllchunk24004;
typedef struct tbigchunk23240 tbigchunk23240;
typedef struct tintset23215 tintset23215;
typedef struct ttrunk23211 ttrunk23211;
typedef struct tavlnode24008 tavlnode24008;
typedef struct tgcstat43614 tgcstat43614;
typedef struct tstringtable123810 tstringtable123810;
typedef struct tstream126629 tstream126629;
typedef struct tfilehandlestream129805 tfilehandlestream129805;
typedef struct tkeyvaluepairseq123808 tkeyvaluepairseq123808;
typedef struct TY99504 TY99504;
typedef struct tsecurityattributes95862 tsecurityattributes95862;
typedef struct tstartupinfo95864 tstartupinfo95864;
typedef struct tprocessinformation95866 tprocessinformation95866;
typedef struct TY131208 TY131208;
typedef struct tbasechunk23236 tbasechunk23236;
typedef struct tfreecell23228 tfreecell23228;
struct  TGenericSeq  {
NI len;
NI reserved;
};
struct  NimStringDesc  {
  TGenericSeq Sup;
NIM_CHAR data[SEQ_DECL_SIZE];
};
typedef NU8 TY124387[32];
typedef NimStringDesc* TY128662[1];
typedef N_NIMCALL_PTR(void, TY2289) (void* p, NI op);
struct  TNimType  {
NI size;
NU8 kind;
NU8 flags;
TNimType* base;
TNimNode* node;
void* finalizer;
TY2289 marker;
};
struct  TNimObject  {
TNimType* m_type;
};
struct  tprocess128402  {
  TNimObject Sup;
NI Fprocesshandle;
int Inhandle;
int Outhandle;
int Errhandle;
NI Id;
int Exitcode;
};
struct  TNimNode  {
NU8 kind;
NI offset;
TNimType* typ;
NCSTRING name;
NI len;
TNimNode** sons;
};
struct  tcell41688  {
NI Refcount;
TNimType* Typ;
};
struct  tcellseq41704  {
NI Len;
NI Cap;
tcell41688** D;
};
struct  tcellset41700  {
NI Counter;
NI Max;
tpagedesc41696* Head;
tpagedesc41696** Data;
};
typedef tsmallchunk23238* TY24022[512];
typedef ttrunk23211* ttrunkbuckets23213[256];
struct  tintset23215  {
ttrunkbuckets23213 Data;
};
struct  tmemregion24010  {
NI Minlargeobj;
NI Maxlargeobj;
TY24022 Freesmallchunks;
tllchunk24004* Llmem;
NI Currmem;
NI Maxmem;
NI Freemem;
NI Lastsize;
tbigchunk23240* Freechunkslist;
tintset23215 Chunkstarts;
tavlnode24008* Root;
tavlnode24008* Deleted;
tavlnode24008* Last;
tavlnode24008* Freeavlnodes;
};
struct  tgcstat43614  {
NI Stackscans;
NI Cyclecollections;
NI Maxthreshold;
NI Maxstacksize;
NI Maxstackcells;
NI Cycletablesize;
NI64 Maxpause;
};
struct  tgcheap43616  {
void* Stackbottom;
NI Cyclethreshold;
tcellseq41704 Zct;
tcellseq41704 Decstack;
tcellset41700 Cycleroots;
tcellseq41704 Tempstack;
NI Recgclock;
tmemregion24010 Region;
tgcstat43614 Stat;
};
typedef N_NIMCALL_PTR(void, TY126630) (tstream126629* s);
typedef N_NIMCALL_PTR(NIM_BOOL, TY126634) (tstream126629* s);
typedef N_NIMCALL_PTR(void, TY126638) (tstream126629* s, NI pos);
typedef N_NIMCALL_PTR(NI, TY126643) (tstream126629* s);
typedef N_NIMCALL_PTR(NI, TY126647) (tstream126629* s, void* buffer, NI buflen);
typedef N_NIMCALL_PTR(void, TY126653) (tstream126629* s, void* buffer, NI buflen);
typedef N_NIMCALL_PTR(void, TY126659) (tstream126629* s);
struct  tstream126629  {
  TNimObject Sup;
TY126630 Closeimpl;
TY126634 Atendimpl;
TY126638 Setpositionimpl;
TY126643 Getpositionimpl;
TY126647 Readdataimpl;
TY126653 Writedataimpl;
TY126659 Flushimpl;
};
struct  tfilehandlestream129805  {
  tstream126629 Sup;
NI Handle;
NIM_BOOL Attheend;
};
typedef N_STDCALL_PTR(NI32, TY96025) (NI hfile, void* buffer, NI32 nnumberofbytestoread, NI32* lpnumberofbytesread, void* lpoverlapped);
typedef N_STDCALL_PTR(NI32, TY96034) (NI hfile, void* buffer, NI32 nnumberofbytestowrite, NI32* lpnumberofbyteswritten, void* lpoverlapped);
struct TY99504 {
NimStringDesc* Field0;
NimStringDesc* Field1;
};
struct  tstringtable123810  {
  TNimObject Sup;
NI Counter;
tkeyvaluepairseq123808* Data;
NU8 Mode;
};
struct  tsecurityattributes95862  {
NI32 Nlength;
void* Lpsecuritydescriptor;
NI32 Binherithandle;
};
typedef N_STDCALL_PTR(NI32, TY96043) (NI* hreadpipe, NI* hwritepipe, tsecurityattributes95862* lppipeattributes, NI32 nsize);
typedef N_STDCALL_PTR(NI32, TY96021) (NI hobject);
struct  tstartupinfo95864  {
NI32 Cb;
NCSTRING Lpreserved;
NCSTRING Lpdesktop;
NCSTRING Lptitle;
NI32 Dwx;
NI32 Dwy;
NI32 Dwxsize;
NI32 Dwysize;
NI32 Dwxcountchars;
NI32 Dwycountchars;
NI32 Dwfillattribute;
NI32 Dwflags;
NI16 Wshowwindow;
NI16 Cbreserved2;
void* Lpreserved2;
NI Hstdinput;
NI Hstdoutput;
NI Hstderror;
};
struct  tprocessinformation95866  {
NI Hprocess;
NI Hthread;
NI32 Dwprocessid;
NI32 Dwthreadid;
};
typedef N_STDCALL_PTR(NI, TY96227) (NI32 nstdhandle);
typedef N_STDCALL_PTR(NI32, TY96052) (NI16* lpapplicationname, NI16* lpcommandline, tsecurityattributes95862* lpprocessattributes, tsecurityattributes95862* lpthreadattributes, NI32 binherithandles, NI32 dwcreationflags, NI16* lpenvironment, NI16* lpcurrentdirectory, tstartupinfo95864* lpstartupinfo, tprocessinformation95866* lpprocessinformation);
typedef N_STDCALL_PTR(NI32, TY96203) (NI hthread);
typedef N_STDCALL_PTR(NI32, TY96207) (NI hthread);
typedef N_STDCALL_PTR(NI32, TY96211) (NI hhandle, NI32 dwmilliseconds);
typedef N_STDCALL_PTR(NI32, TY96216) (NI hprocess, NI uexitcode);
typedef N_STDCALL_PTR(NI32, TY96221) (NI hprocess, NI32* lpexitcode);
typedef NI twohandlearray97781[64];
typedef N_STDCALL_PTR(NI32, TY97787) (NI32 ncount, NI* lphandles, NI32 bwaitall, NI32 dwmilliseconds);
struct TY131208 {
NimStringDesc* Field0;
NI Field1;
};
typedef NI TY23218[16];
struct  tpagedesc41696  {
tpagedesc41696* Next;
NI Key;
TY23218 Bits;
};
struct  tbasechunk23236  {
NI Prevsize;
NI Size;
NIM_BOOL Used;
};
struct  tsmallchunk23238  {
  tbasechunk23236 Sup;
tsmallchunk23238* Next;
tsmallchunk23238* Prev;
tfreecell23228* Freelist;
NI Free;
NI Acc;
NF Data;
};
struct  tllchunk24004  {
NI Size;
NI Acc;
tllchunk24004* Next;
};
struct  tbigchunk23240  {
  tbasechunk23236 Sup;
tbigchunk23240* Next;
tbigchunk23240* Prev;
NI Align;
NF Data;
};
struct  ttrunk23211  {
ttrunk23211* Next;
NI Key;
TY23218 Bits;
};
typedef tavlnode24008* TY24014[2];
struct  tavlnode24008  {
TY24014 Link;
NI Key;
NI Upperbound;
NI Level;
};
struct  tfreecell23228  {
tfreecell23228* Next;
NI Zerofield;
};
struct TY129403 {
  TGenericSeq Sup;
  tprocess128402* data[SEQ_DECL_SIZE];
};
struct tkeyvaluepairseq123808 {
  TGenericSeq Sup;
  TY99504 data[SEQ_DECL_SIZE];
};
N_NIMCALL(NimStringDesc*, nospquoteShellWindows)(NimStringDesc* s);
N_NIMCALL(NIM_BOOL, contains_92258)(NimStringDesc* s, TY124387 chars);
N_NIMCALL(NimStringDesc*, copyString)(NimStringDesc* src);
static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src);
N_NIMCALL(NimStringDesc*, resizeString)(NimStringDesc* dest, NI addlen);
N_NOINLINE(void, raiseIndexError)(void);
N_NIMCALL(NimStringDesc*, addChar)(NimStringDesc* s, NIM_CHAR c);
N_NIMCALL(NimStringDesc*, setLengthStr)(NimStringDesc* s, NI newlen);
static N_INLINE(NI, addInt)(NI a, NI b);
N_NOINLINE(void, raiseOverflow)(void);
N_NIMCALL(void, failedassertimpl_81621)(NimStringDesc* msg);
static N_INLINE(void, nimFrame)(TFrame* s);
static N_INLINE(void, popFrame)(void);
N_NIMCALL(NimStringDesc*, nospquoteShellPosix)(NimStringDesc* s);
N_NIMCALL(NIM_BOOL, allcharsinset_91836)(NimStringDesc* s, TY124387 theset);
N_NIMCALL(NimStringDesc*, nsuReplaceStr)(NimStringDesc* s, NimStringDesc* sub, NimStringDesc* by);
N_NIMCALL(NimStringDesc*, rawNewString)(NI space);
N_NIMCALL(NimStringDesc*, nospquoteShell)(NimStringDesc* s);
N_NIMCALL(tprocess128402*, startcmd_128634)(NimStringDesc* command, NU8 options);
N_NIMCALL(NI, nospprocessID)(tprocess128402* p);
N_NIMCALL(int, nospinputHandle)(tprocess128402* p);
N_NIMCALL(int, nospoutputHandle)(tprocess128402* p);
N_NIMCALL(int, nosperrorHandle)(tprocess128402* p);
N_NIMCALL(NI, nospcountProcessors)(void);
N_NIMCALL(NimStringDesc*, getenv_113225)(NimStringDesc* key);
N_NIMCALL(NI, nsuParseInt)(NimStringDesc* s);
N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** cmds, NI cmdsLen0, NU8 options, NI n);
N_NIMCALL(void, TMP374)(void* p, NI op);
N_NIMCALL(void, nimGCvisit)(void* d, NI op);
N_NIMCALL(void, TMP375)(void* p, NI op);
N_NIMCALL(void*, newSeq)(TNimType* typ, NI len);
static N_INLINE(NI, subInt)(NI a, NI b);
static N_INLINE(void, asgnRef)(void** dest, void* src);
static N_INLINE(void, incref_47427)(tcell41688* c);
static N_INLINE(NIM_BOOL, canbecycleroot_45062)(tcell41688* c);
static N_INLINE(void, rtladdcycleroot_45835)(tcell41688* c);
N_NOINLINE(void, incl_42455)(tcellset41700* s, tcell41688* cell);
static N_INLINE(tcell41688*, usrtocell_45043)(void* usr);
static N_INLINE(void, decref_47002)(tcell41688* c);
static N_INLINE(void, rtladdzct_46602)(tcell41688* c);
N_NOINLINE(void, addzct_45018)(tcellseq41704* s, tcell41688* c);
N_NIMCALL(void, nossleep)(NI milsecs);
N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* command, NimStringDesc** args, NI argsLen0, tstringtable123810* env, NU8 options);
N_NIMCALL(NimStringDesc*, rawNewString)(NI cap);
N_NIMCALL(NIM_BOOL, readline_127004)(tstream126629* s, NimStringDesc** line);
N_NIMCALL(void, del_131052)(TY129403** x_131060, NI i_131064);
N_NIMCALL(void, hsclose_129808)(tstream126629* s);
N_NIMCALL(NIM_BOOL, hsatend_129812)(tstream126629* s);
N_NIMCALL(void, chckObj)(TNimType* obj, TNimType* subclass);
N_NIMCALL(NI, hsreaddata_129817)(tstream126629* s_129819, void* buffer, NI buflen);
N_NIMCALL(void, oserror_104831)(NI32 errorcode);
N_NIMCALL(NI32, oslasterror_104857)(void);
N_NIMCALL(void, hswritedata_129831)(tstream126629* s_129833, void* buffer, NI buflen);
N_NIMCALL(tfilehandlestream129805*, newfilehandlestream_129843)(NI handle);
N_NIMCALL(void, TMP386)(void* p, NI op);
N_NIMCALL(void*, newObj)(TNimType* typ, NI size);
N_NIMCALL(NCSTRING, buildcommandline_129864)(NimStringDesc* a, NimStringDesc** args, NI argsLen0);
N_NOCONV(void*, alloc0_4616)(NI size);
N_NIMCALL(NCSTRING, buildenv_129889)(tstringtable123810* env);
N_NIMCALL(void, createpipehandles_129948)(NI* rdhandle, NI* wrhandle);
static N_INLINE(void, fileclose_129962)(NI h);
N_NIMCALL(tprocess128402*, nospstartProcess)(NimStringDesc* command, NimStringDesc* workingdir, NimStringDesc** args, NI argsLen0, tstringtable123810* env, NU8 options);
N_NIMCALL(NimStringDesc*, cstrToNimstr)(NCSTRING str);
N_NIMCALL(NI16*, newwidecstring_74750)(NCSTRING s);
N_NOCONV(void, dealloc_4645)(void* p);
N_NIMCALL(void, nospsuspend)(tprocess128402* p);
N_NIMCALL(void, nospresume)(tprocess128402* p);
N_NIMCALL(NIM_BOOL, nosprunning)(tprocess128402* p);
N_NIMCALL(void, nospterminate)(tprocess128402* p);
N_NIMCALL(NI, nospwaitForExit)(tprocess128402* p, NI timeout);
N_NIMCALL(NI, peekexitcode_128696)(tprocess128402* p);
N_NIMCALL(tstream126629*, nospinputStream)(tprocess128402* p);
N_NIMCALL(tstream126629*, nospoutputStream)(tprocess128402* p);
N_NIMCALL(tstream126629*, nosperrorStream)(tprocess128402* p);
N_NIMCALL(NI, nospexecCmd)(NimStringDesc* command);
N_NIMCALL(NI16*, newwidecstring_74803)(NimStringDesc* s);
N_NIMCALL(NI, select_129721)(TY129403** readfds, NI timeout);
N_NIMCALL(void, execcmdex_131202)(NimStringDesc* command, NU8 options, TY131208* Result);
N_NIMCALL(void, unsureAsgnRef)(void** dest, void* src);
N_NIMCALL(void, nospclose)(tprocess128402* p);
static NIM_CONST TY124387 TMP344 = {
0x00, 0x02, 0x00, 0x00, 0x01, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP345, "", 0);
STRING_LITERAL(TMP346, "\"", 1);
STRING_LITERAL(TMP347, "\\\"", 2);
STRING_LITERAL(TMP348, "len(a) == L string modified while iterating over it", 51);
NIM_CONST TY124387 safeunixchars_128440 = {
0x00, 0x00, 0x00, 0x00, 0x20, 0xE8, 0xFF, 0x27,
0xFF, 0xFF, 0xFF, 0x87, 0xFE, 0xFF, 0xFF, 0x07,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP349, "\'\'", 2);
static NIM_CONST TY124387 TMP351 = {
0x00, 0x00, 0x00, 0x00, 0x20, 0xE8, 0xFF, 0x27,
0xFF, 0xFF, 0xFF, 0x87, 0xFE, 0xFF, 0xFF, 0x07,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00}
;
STRING_LITERAL(TMP352, "\'", 1);
STRING_LITERAL(TMP363, "\'\"\'\"\'", 5);
STRING_LITERAL(TMP364, "NUMBER_OF_PROCESSORS", 20);
STRING_LITERAL(TMP372, "n > 0 ", 6);
STRING_LITERAL(TMP379, "", 0);
STRING_LITERAL(TMP380, "\015\012", 2);
STRING_LITERAL(TMP391, "=", 1);
STRING_LITERAL(TMP394, "args.len == 0 ", 14);
STRING_LITERAL(TMP395, "readfds.len <= MAXIMUM_WAIT_OBJECTS ", 36);
NIM_CONST TY131208 TMP398 = {((NimStringDesc*) &TMP379),
-1}
;
extern TFrame* frameptr_13238;
extern TNimType NTI2409; /* TObject */
TNimType NTI128402; /* TProcess */
extern TNimType NTI95842; /* THandle */
extern TNimType NTI10208; /* TFileHandle */
extern TNimType NTI4409; /* cint */
TNimType NTI128404; /* PProcess */
TNimType NTI129403; /* seq[PProcess] */
extern tgcheap43616 gch_43644;
extern TNimType NTI126629; /* TStream */
TNimType NTI129805; /* TFileHandleStream */
extern TNimType NTI134; /* bool */
extern TY96025 Dl_96024;
extern TY96034 Dl_96033;
TNimType NTI129803; /* PFileHandleStream */
extern TY96043 Dl_96042;
extern TY96021 Dl_96020;
extern TY96227 Dl_96226;
extern TY96052 Dl_96051;
extern TY96203 Dl_96202;
extern TY96207 Dl_96206;
extern TY96211 Dl_96210;
extern TY96216 Dl_96215;
extern TY96221 Dl_96220;
extern TY97787 Dl_97786;

static N_INLINE(void, appendString)(NimStringDesc* dest, NimStringDesc* src) {
	memcpy(((NCSTRING) (&(*dest).data[((*dest).Sup.len)- 0])), ((NCSTRING) ((*src).data)), (NI32)((*src).Sup.len + 1));
	(*dest).Sup.len += (*src).Sup.len;
}

static N_INLINE(NI, addInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU32)(a) + (NU32)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ b));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

static N_INLINE(void, nimFrame)(TFrame* s) {
	(*s).prev = frameptr_13238;
	frameptr_13238 = s;
}

static N_INLINE(void, popFrame)(void) {
	frameptr_13238 = (*frameptr_13238).prev;
}

N_NIMCALL(NimStringDesc*, nospquoteShellWindows)(NimStringDesc* s) {
	NimStringDesc* result;
	NIM_BOOL needquote;
	NIM_BOOL LOC1;
	NimStringDesc* backslashbuff;
	NIM_CHAR c_128428;
	NI i_128430;
	NI l_128432;
	nimfr("quoteShellWindows", "osproc.nim")
	result = 0;
	nimln(57, "osproc.nim");
	nimln(57, "osproc.nim");
	LOC1 = 0;
	nimln(57, "osproc.nim");
	LOC1 = contains_92258(s, TMP344);
	if (LOC1) goto LA2;
	nimln(57, "osproc.nim");
	nimln(57, "osproc.nim");
	LOC1 = (s->Sup.len == 0);
	LA2: ;
	needquote = LOC1;
	nimln(59, "osproc.nim");
	result = copyString(((NimStringDesc*) &TMP345));
	nimln(60, "osproc.nim");
	backslashbuff = copyString(((NimStringDesc*) &TMP345));
	nimln(61, "osproc.nim");
	{
		if (!needquote) goto LA5;
		nimln(62, "osproc.nim");
		result = resizeString(result, 1);
appendString(result, ((NimStringDesc*) &TMP346));
	}
	LA5: ;
	c_128428 = 0;
	nimln(2802, "system.nim");
	i_128430 = 0;
	nimln(2803, "system.nim");
	nimln(2803, "system.nim");
	l_128432 = s->Sup.len;
	nimln(2804, "system.nim");
	while (1) {
		nimln(2804, "system.nim");
		if (!(i_128430 < l_128432)) goto LA7;
		nimln(2805, "system.nim");
		if ((NU)(i_128430) > (NU)(s->Sup.len)) raiseIndexError();
		c_128428 = s->data[i_128430];
		nimln(65, "osproc.nim");
		{
			nimln(65, "osproc.nim");
			if (!((NU8)(c_128428) == (NU8)(92))) goto LA10;
			nimln(66, "osproc.nim");
			backslashbuff = addChar(backslashbuff, c_128428);
		}
		goto LA8;
		LA10: ;
		{
			nimln(67, "osproc.nim");
			if (!((NU8)(c_128428) == (NU8)(34))) goto LA13;
			nimln(68, "osproc.nim");
			result = resizeString(result, backslashbuff->Sup.len + 0);
appendString(result, backslashbuff);
			nimln(69, "osproc.nim");
			result = resizeString(result, backslashbuff->Sup.len + 0);
appendString(result, backslashbuff);
			nimln(70, "osproc.nim");
			backslashbuff = setLengthStr(backslashbuff, 0);
			nimln(71, "osproc.nim");
			result = resizeString(result, 2);
appendString(result, ((NimStringDesc*) &TMP347));
		}
		goto LA8;
		LA13: ;
		{
			nimln(73, "osproc.nim");
			{
				nimln(73, "osproc.nim");
				nimln(73, "osproc.nim");
				nimln(73, "osproc.nim");
				if (!!((backslashbuff->Sup.len == 0))) goto LA18;
				nimln(74, "osproc.nim");
				result = resizeString(result, backslashbuff->Sup.len + 0);
appendString(result, backslashbuff);
				nimln(75, "osproc.nim");
				backslashbuff = setLengthStr(backslashbuff, 0);
			}
			LA18: ;
			nimln(76, "osproc.nim");
			result = addChar(result, c_128428);
		}
		LA8: ;
		nimln(2806, "system.nim");
		i_128430 = addInt(i_128430, 1);
		nimln(2807, "system.nim");
		{
			nimln(2807, "system.nim");
			nimln(2807, "system.nim");
			nimln(2807, "system.nim");
			if (!!((s->Sup.len == l_128432))) goto LA22;
			nimln(2807, "system.nim");
			failedassertimpl_81621(((NimStringDesc*) &TMP348));
		}
		LA22: ;
	} LA7: ;
	nimln(78, "osproc.nim");
	{
		if (!needquote) goto LA26;
		nimln(79, "osproc.nim");
		result = resizeString(result, 1);
appendString(result, ((NimStringDesc*) &TMP346));
	}
	LA26: ;
	popFrame();
	return result;
}

N_NIMCALL(NimStringDesc*, nospquoteShellPosix)(NimStringDesc* s) {
	NimStringDesc* result;
	NIM_BOOL safe;
	nimfr("quoteShellPosix", "osproc.nim")
	result = 0;
	nimln(86, "osproc.nim");
	{
		nimln(86, "osproc.nim");
		nimln(86, "osproc.nim");
		if (!(s->Sup.len == 0)) goto LA3;
		nimln(87, "osproc.nim");
		nimln(87, "osproc.nim");
		result = copyString(((NimStringDesc*) &TMP349));
		goto BeforeRet;
	}
	LA3: ;
	nimln(89, "osproc.nim");
	safe = allcharsinset_91836(s, TMP351);
	nimln(91, "osproc.nim");
	{
		if (!safe) goto LA7;
		nimln(92, "osproc.nim");
		nimln(92, "osproc.nim");
		result = copyString(s);
		goto BeforeRet;
	}
	goto LA5;
	LA7: ;
	{
		NimStringDesc* LOC10;
		NimStringDesc* LOC11;
		nimln(94, "osproc.nim");
		nimln(94, "osproc.nim");
		nimln(94, "osproc.nim");
		LOC10 = 0;
		nimln(94, "osproc.nim");
		LOC11 = 0;
		LOC11 = nsuReplaceStr(s, ((NimStringDesc*) &TMP352), ((NimStringDesc*) &TMP363));
		LOC10 = rawNewString(LOC11->Sup.len + 2);
appendString(LOC10, ((NimStringDesc*) &TMP352));
appendString(LOC10, LOC11);
appendString(LOC10, ((NimStringDesc*) &TMP352));
		result = LOC10;
		goto BeforeRet;
	}
	LA5: ;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(NimStringDesc*, nospquoteShell)(NimStringDesc* s) {
	NimStringDesc* result;
	nimfr("quoteShell", "osproc.nim")
	result = 0;
	nimln(99, "osproc.nim");
	nimln(99, "osproc.nim");
	result = nospquoteShellWindows(s);
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(tprocess128402*, startcmd_128634)(NimStringDesc* command, NU8 options) {
	tprocess128402* result;
	TY128662 LOC1;
	nimfr("startCmd", "osproc.nim")
	result = 0;
	nimln(155, "osproc.nim");
	memset((void*)LOC1, 0, sizeof(LOC1));
	nimln(155, "osproc.nim");
	result = nospstartProcess(command, ((NimStringDesc*) &TMP345), LOC1, 0, NIM_NIL, (options | 4));
	popFrame();
	return result;
}

N_NIMCALL(NI, nospprocessID)(tprocess128402* p) {
	NI result;
	nimfr("processID", "osproc.nim")
	result = 0;
	nimln(174, "osproc.nim");
	nimln(174, "osproc.nim");
	result = (*p).Id;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(int, nospinputHandle)(tprocess128402* p) {
	int result;
	nimfr("inputHandle", "osproc.nim")
	result = 0;
	nimln(210, "osproc.nim");
	result = (*p).Inhandle;
	popFrame();
	return result;
}

N_NIMCALL(int, nospoutputHandle)(tprocess128402* p) {
	int result;
	nimfr("outputHandle", "osproc.nim")
	result = 0;
	nimln(218, "osproc.nim");
	result = (*p).Outhandle;
	popFrame();
	return result;
}

N_NIMCALL(int, nosperrorHandle)(tprocess128402* p) {
	int result;
	nimfr("errorHandle", "osproc.nim")
	result = 0;
	nimln(226, "osproc.nim");
	result = (*p).Errhandle;
	popFrame();
	return result;
}

N_NIMCALL(NI, nospcountProcessors)(void) {
	NI result;
	NimStringDesc* x;
	nimfr("countProcessors", "osproc.nim")
	result = 0;
	nimln(241, "osproc.nim");
	x = getenv_113225(((NimStringDesc*) &TMP364));
	nimln(242, "osproc.nim");
	{
		nimln(242, "osproc.nim");
		nimln(242, "osproc.nim");
		if (!(0 < x->Sup.len)) goto LA3;
		nimln(242, "osproc.nim");
		result = nsuParseInt(x);
	}
	LA3: ;
	nimln(263, "osproc.nim");
	{
		nimln(263, "osproc.nim");
		if (!(result <= 0)) goto LA7;
		nimln(263, "osproc.nim");
		result = 1;
	}
	LA7: ;
	popFrame();
	return result;
}
N_NIMCALL(void, TMP374)(void* p, NI op) {
	tprocess128402* a;
	a = (tprocess128402*)p;
}
N_NIMCALL(void, TMP375)(void* p, NI op) {
	TY129403* a;
	NI LOC1;
	a = (TY129403*)p;
	LOC1 = 0;
	for (LOC1 = 0; LOC1 < a->Sup.len; LOC1++) {
	nimGCvisit((void*)a->data[LOC1], op);
	}
}

static N_INLINE(NI, subInt)(NI a, NI b) {
	NI result;
	result = 0;
	result = (NI)((NU32)(a) - (NU32)(b));
	{
		NIM_BOOL LOC3;
		LOC3 = 0;
		LOC3 = (0 <= (NI)(result ^ a));
		if (LOC3) goto LA4;
		LOC3 = (0 <= (NI)(result ^ (NI)((NU32) ~(b))));
		LA4: ;
		if (!LOC3) goto LA5;
		goto BeforeRet;
	}
	LA5: ;
	raiseOverflow();
	BeforeRet: ;
	return result;
}

static N_INLINE(NIM_BOOL, canbecycleroot_45062)(tcell41688* c) {
	NIM_BOOL result;
	nimfr("canbeCycleRoot", "gc.nim")
	result = 0;
	nimln(121, "gc.nim");
	nimln(121, "gc.nim");
	nimln(121, "gc.nim");
	result = !((((*(*c).Typ).flags &(1<<((((NU8) 1))&7)))!=0));
	popFrame();
	return result;
}

static N_INLINE(void, rtladdcycleroot_45835)(tcell41688* c) {
	nimfr("rtlAddCycleRoot", "gc.nim")
	nimln(189, "gc.nim");
	{
		nimln(189, "gc.nim");
		nimln(189, "gc.nim");
		nimln(189, "gc.nim");
		if (!!((((NI) ((NI)((*c).Refcount & 3))) == 3))) goto LA3;
		nimln(139, "gc.nim");
		nimln(139, "gc.nim");
		nimln(139, "gc.nim");
		(*c).Refcount = (NI)((NI)((*c).Refcount & -4) | 3);
		nimln(191, "gc.nim");
		incl_42455(&gch_43644.Cycleroots, c);
	}
	LA3: ;
	popFrame();
}

static N_INLINE(void, incref_47427)(tcell41688* c) {
	nimfr("incRef", "gc.nim")
	nimln(216, "gc.nim");
	nimln(216, "gc.nim");
	(*c).Refcount = (NI)((NU32)((*c).Refcount) + (NU32)(8));
	nimln(219, "gc.nim");
	{
		NIM_BOOL LOC3;
		nimln(219, "gc.nim");
		LOC3 = 0;
		LOC3 = canbecycleroot_45062(c);
		if (!LOC3) goto LA4;
		nimln(220, "gc.nim");
		rtladdcycleroot_45835(c);
	}
	LA4: ;
	popFrame();
}

static N_INLINE(tcell41688*, usrtocell_45043)(void* usr) {
	tcell41688* result;
	nimfr("usrToCell", "gc.nim")
	result = 0;
	nimln(118, "gc.nim");
	nimln(118, "gc.nim");
	nimln(118, "gc.nim");
	result = ((tcell41688*) ((NI)((NU32)(((NI) (usr))) - (NU32)(((NI)sizeof(tcell41688))))));
	popFrame();
	return result;
}

static N_INLINE(void, rtladdzct_46602)(tcell41688* c) {
	nimfr("rtlAddZCT", "gc.nim")
	nimln(199, "gc.nim");
	addzct_45018(&gch_43644.Zct, c);
	popFrame();
}

static N_INLINE(void, decref_47002)(tcell41688* c) {
	nimfr("decRef", "gc.nim")
	nimln(206, "gc.nim");
	{
		nimln(167, "gc.nim");
		(*c).Refcount -= 8;
		nimln(168, "gc.nim");
		if (!((NU32)((*c).Refcount) < (NU32)(8))) goto LA3;
		nimln(207, "gc.nim");
		rtladdzct_46602(c);
	}
	goto LA1;
	LA3: ;
	{
		NIM_BOOL LOC6;
		nimln(208, "gc.nim");
		LOC6 = 0;
		LOC6 = canbecycleroot_45062(c);
		if (!LOC6) goto LA7;
		nimln(211, "gc.nim");
		rtladdcycleroot_45835(c);
	}
	goto LA1;
	LA7: ;
	LA1: ;
	popFrame();
}

static N_INLINE(void, asgnRef)(void** dest, void* src) {
	nimfr("asgnRef", "gc.nim")
	nimln(244, "gc.nim");
	{
		tcell41688* LOC5;
		nimln(244, "gc.nim");
		nimln(244, "gc.nim");
		if (!!((src == NIM_NIL))) goto LA3;
		nimln(244, "gc.nim");
		nimln(244, "gc.nim");
		LOC5 = 0;
		LOC5 = usrtocell_45043(src);
		incref_47427(LOC5);
	}
	LA3: ;
	nimln(245, "gc.nim");
	{
		tcell41688* LOC10;
		nimln(245, "gc.nim");
		nimln(245, "gc.nim");
		if (!!(((*dest) == NIM_NIL))) goto LA8;
		nimln(245, "gc.nim");
		nimln(245, "gc.nim");
		LOC10 = 0;
		LOC10 = usrtocell_45043((*dest));
		decref_47002(LOC10);
	}
	LA8: ;
	nimln(246, "gc.nim");
	(*dest) = src;
	popFrame();
}

N_NIMCALL(NI, nospexecProcesses)(NimStringDesc** cmds, NI cmdsLen0, NU8 options, NI n) {
	NI result;
	nimfr("execProcesses", "osproc.nim")
	result = 0;
	nimln(276, "osproc.nim");
	{
		nimln(276, "osproc.nim");
		nimln(276, "osproc.nim");
		if (!!((0 < n))) goto LA3;
		nimln(276, "osproc.nim");
		failedassertimpl_81621(((NimStringDesc*) &TMP372));
	}
	LA3: ;
	nimln(277, "osproc.nim");
	{
		TY129403* q;
		NI m;
		NI i_129442;
		NI HEX3Atmp_129698;
		NI TMP376;
		NI res_129700;
		NI i;
		NI j_129661;
		NI HEX3Atmp_129706;
		NI TMP378;
		NI res_129708;
		nimln(277, "osproc.nim");
		if (!(1 < n)) goto LA7;
		q = 0;
		nimln(279, "osproc.nim");
		q = (TY129403*) newSeq((&NTI129403), n);
		nimln(280, "osproc.nim");
		nimln(280, "osproc.nim");
		nimln(280, "osproc.nim");
		m = ((n <= cmdsLen0) ? n : cmdsLen0);
		i_129442 = 0;
		HEX3Atmp_129698 = 0;
		nimln(281, "osproc.nim");
		nimln(281, "osproc.nim");
		TMP376 = subInt(m, 1);
		HEX3Atmp_129698 = (NI32)(TMP376);
		nimln(1458, "system.nim");
		res_129700 = 0;
		nimln(1459, "system.nim");
		while (1) {
			nimln(1459, "system.nim");
			if (!(res_129700 <= HEX3Atmp_129698)) goto LA9;
			nimln(1458, "system.nim");
			i_129442 = res_129700;
			nimln(282, "osproc.nim");
			if ((NU)(i_129442) >= (NU)(q->Sup.len)) raiseIndexError();
			if ((NU)(i_129442) >= (NU)(cmdsLen0)) raiseIndexError();
			asgnRef((void**) &q->data[i_129442], startcmd_128634(cmds[i_129442], options));
			nimln(1461, "system.nim");
			res_129700 = addInt(res_129700, 1);
		} LA9: ;
		nimln(298, "osproc.nim");
		i = m;
		nimln(299, "osproc.nim");
		while (1) {
			NI r_129613;
			NI HEX3Atmp_129702;
			NI TMP377;
			NI res_129704;
			nimln(299, "osproc.nim");
			nimln(299, "osproc.nim");
			if (!(i <= (cmdsLen0-1))) goto LA10;
			nimln(300, "osproc.nim");
			nossleep(50);
			r_129613 = 0;
			HEX3Atmp_129702 = 0;
			nimln(301, "osproc.nim");
			nimln(301, "osproc.nim");
			TMP377 = subInt(n, 1);
			HEX3Atmp_129702 = (NI32)(TMP377);
			nimln(1458, "system.nim");
			res_129704 = 0;
			nimln(1459, "system.nim");
			while (1) {
				nimln(1459, "system.nim");
				if (!(res_129704 <= HEX3Atmp_129702)) goto LA11;
				nimln(1458, "system.nim");
				r_129613 = res_129704;
				nimln(302, "osproc.nim");
				{
					NIM_BOOL LOC14;
					NI LOC17;
					nimln(302, "osproc.nim");
					nimln(302, "osproc.nim");
					if ((NU)(r_129613) >= (NU)(q->Sup.len)) raiseIndexError();
					LOC14 = 0;
					LOC14 = nosprunning(q->data[r_129613]);
					if (!!(LOC14)) goto LA15;
					nimln(304, "osproc.nim");
					nimln(304, "osproc.nim");
					nimln(304, "osproc.nim");
					if ((NU)(r_129613) >= (NU)(q->Sup.len)) raiseIndexError();
					LOC17 = 0;
					LOC17 = nospwaitForExit(q->data[r_129613], -1);
					result = ((LOC17 >= result) ? LOC17 : result);
					nimln(305, "osproc.nim");
					{
						nimln(305, "osproc.nim");
						nimln(305, "osproc.nim");
						if ((NU)(r_129613) >= (NU)(q->Sup.len)) raiseIndexError();
						if (!!((q->data[r_129613] == NIM_NIL))) goto LA20;
						nimln(305, "osproc.nim");
						if ((NU)(r_129613) >= (NU)(q->Sup.len)) raiseIndexError();
						nospclose(q->data[r_129613]);
					}
					LA20: ;
					nimln(306, "osproc.nim");
					if ((NU)(r_129613) >= (NU)(q->Sup.len)) raiseIndexError();
					if ((NU)(i) >= (NU)(cmdsLen0)) raiseIndexError();
					asgnRef((void**) &q->data[r_129613], startcmd_128634(cmds[i], options));
					nimln(307, "osproc.nim");
					i = addInt(i, 1);
					nimln(308, "osproc.nim");
					{
						nimln(308, "osproc.nim");
						nimln(308, "osproc.nim");
						if (!((cmdsLen0-1) < i)) goto LA24;
						nimln(308, "osproc.nim");
						goto LA11;
					}
					LA24: ;
				}
				LA15: ;
				nimln(1461, "system.nim");
				res_129704 = addInt(res_129704, 1);
			} LA11: ;
		} LA10: ;
		j_129661 = 0;
		HEX3Atmp_129706 = 0;
		nimln(309, "osproc.nim");
		nimln(309, "osproc.nim");
		TMP378 = subInt(m, 1);
		HEX3Atmp_129706 = (NI32)(TMP378);
		nimln(1458, "system.nim");
		res_129708 = 0;
		nimln(1459, "system.nim");
		while (1) {
			NI LOC27;
			nimln(1459, "system.nim");
			if (!(res_129708 <= HEX3Atmp_129706)) goto LA26;
			nimln(1458, "system.nim");
			j_129661 = res_129708;
			nimln(310, "osproc.nim");
			nimln(310, "osproc.nim");
			nimln(310, "osproc.nim");
			if ((NU)(j_129661) >= (NU)(q->Sup.len)) raiseIndexError();
			LOC27 = 0;
			LOC27 = nospwaitForExit(q->data[j_129661], -1);
			result = ((LOC27 >= result) ? LOC27 : result);
			nimln(311, "osproc.nim");
			{
				nimln(311, "osproc.nim");
				nimln(311, "osproc.nim");
				if ((NU)(j_129661) >= (NU)(q->Sup.len)) raiseIndexError();
				if (!!((q->data[j_129661] == NIM_NIL))) goto LA30;
				nimln(311, "osproc.nim");
				if ((NU)(j_129661) >= (NU)(q->Sup.len)) raiseIndexError();
				nospclose(q->data[j_129661]);
			}
			LA30: ;
			nimln(1461, "system.nim");
			res_129708 = addInt(res_129708, 1);
		} LA26: ;
	}
	goto LA5;
	LA7: ;
	{
		NI i_129692;
		NI HEX3Atmp_129710;
		NI res_129712;
		i_129692 = 0;
		HEX3Atmp_129710 = 0;
		nimln(313, "osproc.nim");
		nimln(313, "osproc.nim");
		HEX3Atmp_129710 = (cmdsLen0-1);
		nimln(1458, "system.nim");
		res_129712 = 0;
		nimln(1459, "system.nim");
		while (1) {
			tprocess128402* p;
			NI LOC34;
			nimln(1459, "system.nim");
			if (!(res_129712 <= HEX3Atmp_129710)) goto LA33;
			nimln(1458, "system.nim");
			i_129692 = res_129712;
			nimln(314, "osproc.nim");
			if ((NU)(i_129692) >= (NU)(cmdsLen0)) raiseIndexError();
			p = startcmd_128634(cmds[i_129692], options);
			nimln(315, "osproc.nim");
			nimln(315, "osproc.nim");
			nimln(315, "osproc.nim");
			LOC34 = 0;
			LOC34 = nospwaitForExit(p, -1);
			result = ((LOC34 >= result) ? LOC34 : result);
			nimln(316, "osproc.nim");
			nospclose(p);
			nimln(1461, "system.nim");
			res_129712 = addInt(res_129712, 1);
		} LA33: ;
	}
	LA5: ;
	popFrame();
	return result;
}

N_NIMCALL(NimStringDesc*, nospexecProcess)(NimStringDesc* command, NimStringDesc** args, NI argsLen0, tstringtable123810* env, NU8 options) {
	NimStringDesc* result;
	tprocess128402* p;
	tstream126629* outp;
	NimStringDesc* line;
	nimfr("execProcess", "osproc.nim")
	result = 0;
	nimln(334, "osproc.nim");
	p = nospstartProcess(command, ((NimStringDesc*) &TMP345), args, argsLen0, env, options);
	nimln(335, "osproc.nim");
	outp = nospoutputStream(p);
	nimln(336, "osproc.nim");
	result = copyString(((NimStringDesc*) &TMP379));
	nimln(337, "osproc.nim");
	nimln(337, "osproc.nim");
	line = rawNewString(120);
	nimln(338, "osproc.nim");
	while (1) {
		nimln(340, "osproc.nim");
		{
			NIM_BOOL LOC4;
			nimln(340, "osproc.nim");
			LOC4 = 0;
			LOC4 = readline_127004(outp, &line);
			if (!LOC4) goto LA5;
			nimln(341, "osproc.nim");
			result = resizeString(result, line->Sup.len + 0);
appendString(result, line);
			nimln(342, "osproc.nim");
			result = resizeString(result, 2);
appendString(result, ((NimStringDesc*) &TMP380));
		}
		goto LA2;
		LA5: ;
		{
			NIM_BOOL LOC8;
			nimln(343, "osproc.nim");
			nimln(343, "osproc.nim");
			LOC8 = 0;
			LOC8 = nosprunning(p);
			if (!!(LOC8)) goto LA9;
			nimln(343, "osproc.nim");
			goto LA1;
		}
		goto LA2;
		LA9: ;
		LA2: ;
	} LA1: ;
	nimln(344, "osproc.nim");
	nospclose(p);
	popFrame();
	return result;
}

N_NIMCALL(void, hsclose_129808)(tstream126629* s) {
	nimfr("hsClose", "osproc.nim")
	popFrame();
}

N_NIMCALL(NIM_BOOL, hsatend_129812)(tstream126629* s) {
	NIM_BOOL result;
	nimfr("hsAtEnd", "osproc.nim")
	result = 0;
	nimln(356, "osproc.nim");
	nimln(356, "osproc.nim");
	if (s) chckObj((*s).Sup.m_type, (&NTI129805));
	result = (*((tfilehandlestream129805*) (s))).Attheend;
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(NI, hsreaddata_129817)(tstream126629* s_129819, void* buffer, NI buflen) {
	NI result;
	tfilehandlestream129805* s;
	NI32 br;
	NI32 a;
	nimfr("hsReadData", "osproc.nim")
	result = 0;
	nimln(359, "osproc.nim");
	if (s_129819) chckObj((*s_129819).Sup.m_type, (&NTI129805));
	s = ((tfilehandlestream129805*) (s_129819));
	nimln(360, "osproc.nim");
	{
		if (!(*s).Attheend) goto LA3;
		nimln(360, "osproc.nim");
		nimln(360, "osproc.nim");
		result = 0;
		goto BeforeRet;
	}
	LA3: ;
	br = 0;
	nimln(362, "osproc.nim");
	a = Dl_96024((*s).Handle, buffer, ((int) (buflen)), &br, NIM_NIL);
	nimln(366, "osproc.nim");
	{
		NIM_BOOL LOC7;
		NI32 LOC11;
		nimln(366, "osproc.nim");
		LOC7 = 0;
		nimln(366, "osproc.nim");
		LOC7 = (a == ((NI32) 0));
		if (!(LOC7)) goto LA8;
		nimln(366, "osproc.nim");
		nimln(366, "osproc.nim");
		LOC7 = !((br == ((NI32) 0)));
		LA8: ;
		if (!LOC7) goto LA9;
		nimln(366, "osproc.nim");
		nimln(366, "osproc.nim");
		LOC11 = 0;
		LOC11 = oslasterror_104857();
		oserror_104831(LOC11);
	}
	LA9: ;
	nimln(367, "osproc.nim");
	nimln(367, "osproc.nim");
	(*s).Attheend = (((NI) (br)) < buflen);
	nimln(368, "osproc.nim");
	result = ((NI) (br));
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(void, hswritedata_129831)(tstream126629* s_129833, void* buffer, NI buflen) {
	tfilehandlestream129805* s;
	NI32 byteswritten;
	NI32 a;
	nimfr("hsWriteData", "osproc.nim")
	nimln(371, "osproc.nim");
	if (s_129833) chckObj((*s_129833).Sup.m_type, (&NTI129805));
	s = ((tfilehandlestream129805*) (s_129833));
	byteswritten = 0;
	nimln(373, "osproc.nim");
	a = Dl_96033((*s).Handle, buffer, ((int) (buflen)), &byteswritten, NIM_NIL);
	nimln(374, "osproc.nim");
	{
		NI32 LOC5;
		nimln(374, "osproc.nim");
		if (!(a == ((NI32) 0))) goto LA3;
		nimln(374, "osproc.nim");
		nimln(374, "osproc.nim");
		LOC5 = 0;
		LOC5 = oslasterror_104857();
		oserror_104831(LOC5);
	}
	LA3: ;
	popFrame();
}
N_NIMCALL(void, TMP386)(void* p, NI op) {
	tfilehandlestream129805* a;
	a = (tfilehandlestream129805*)p;
}

N_NIMCALL(tfilehandlestream129805*, newfilehandlestream_129843)(NI handle) {
	tfilehandlestream129805* result;
	nimfr("newFileHandleStream", "osproc.nim")
	result = 0;
	nimln(377, "osproc.nim");
	result = (tfilehandlestream129805*) newObj((&NTI129803), sizeof(tfilehandlestream129805));
	(*result).Sup.Sup.m_type = (&NTI129805);
	nimln(378, "osproc.nim");
	(*result).Handle = handle;
	nimln(379, "osproc.nim");
	(*result).Sup.Closeimpl = hsclose_129808;
	nimln(380, "osproc.nim");
	(*result).Sup.Atendimpl = hsatend_129812;
	nimln(381, "osproc.nim");
	(*result).Sup.Readdataimpl = hsreaddata_129817;
	nimln(382, "osproc.nim");
	(*result).Sup.Writedataimpl = hswritedata_129831;
	popFrame();
	return result;
}

N_NIMCALL(NCSTRING, buildcommandline_129864)(NimStringDesc* a, NimStringDesc** args, NI argsLen0) {
	NCSTRING result;
	NimStringDesc* res;
	NI i_129881;
	NI HEX3Atmp_129882;
	NI res_129884;
	NI TMP387;
	void* LOC3;
	nimfr("buildCommandLine", "osproc.nim")
	result = 0;
	nimln(385, "osproc.nim");
	res = nospquoteShell(a);
	i_129881 = 0;
	HEX3Atmp_129882 = 0;
	nimln(386, "osproc.nim");
	nimln(386, "osproc.nim");
	HEX3Atmp_129882 = (argsLen0-1);
	nimln(1458, "system.nim");
	res_129884 = 0;
	nimln(1459, "system.nim");
	while (1) {
		NimStringDesc* LOC2;
		nimln(1459, "system.nim");
		if (!(res_129884 <= HEX3Atmp_129882)) goto LA1;
		nimln(1458, "system.nim");
		i_129881 = res_129884;
		nimln(387, "osproc.nim");
		res = addChar(res, 32);
		nimln(388, "osproc.nim");
		nimln(388, "osproc.nim");
		if ((NU)(i_129881) >= (NU)(argsLen0)) raiseIndexError();
		LOC2 = 0;
		LOC2 = nospquoteShell(args[i_129881]);
		res = resizeString(res, LOC2->Sup.len + 0);
appendString(res, LOC2);
		nimln(1461, "system.nim");
		res_129884 = addInt(res_129884, 1);
	} LA1: ;
	nimln(389, "osproc.nim");
	nimln(389, "osproc.nim");
	nimln(389, "osproc.nim");
	nimln(389, "osproc.nim");
	TMP387 = addInt(res->Sup.len, 1);
	LOC3 = 0;
	LOC3 = alloc0_4616((NI32)(TMP387));
	result = ((NCSTRING) (LOC3));
	nimln(390, "osproc.nim");
	nimln(390, "osproc.nim");
	memcpy(((void*) (result)), ((void*) (res->data)), res->Sup.len);
	popFrame();
	return result;
}

N_NIMCALL(NCSTRING, buildenv_129889)(tstringtable123810* env) {
	NCSTRING result;
	NI l;
	NimStringDesc* key_129894;
	NimStringDesc* val_129895;
	NI h_129933;
	NI HEX3Atmp_129935;
	NI res_129937;
	NI TMP390;
	void* LOC6;
	NimStringDesc* key_129912;
	NimStringDesc* val_129913;
	NI h_129940;
	NI HEX3Atmp_129942;
	NI res_129944;
	nimfr("buildEnv", "osproc.nim")
	result = 0;
	nimln(393, "osproc.nim");
	l = 0;
	key_129894 = 0;
	val_129895 = 0;
	h_129933 = 0;
	HEX3Atmp_129935 = 0;
	nimln(40, "strtabs.nim");
	nimln(40, "strtabs.nim");
	HEX3Atmp_129935 = ((*env).Data->Sup.len-1);
	nimln(1458, "system.nim");
	res_129937 = 0;
	nimln(1459, "system.nim");
	while (1) {
		nimln(1459, "system.nim");
		if (!(res_129937 <= HEX3Atmp_129935)) goto LA1;
		nimln(1458, "system.nim");
		h_129933 = res_129937;
		nimln(41, "strtabs.nim");
		{
			NI TMP388;
			NI TMP389;
			nimln(41, "strtabs.nim");
			nimln(41, "strtabs.nim");
			if ((NU)(h_129933) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			if (!!((*env).Data->data[h_129933].Field0 == 0)) goto LA4;
			nimln(42, "strtabs.nim");
			if ((NU)(h_129933) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			key_129894 = (*env).Data->data[h_129933].Field0;
			nimln(42, "strtabs.nim");
			if ((NU)(h_129933) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			val_129895 = (*env).Data->data[h_129933].Field1;
			nimln(394, "osproc.nim");
			nimln(394, "osproc.nim");
			nimln(394, "osproc.nim");
			nimln(394, "osproc.nim");
			nimln(394, "osproc.nim");
			TMP388 = addInt(key_129894->Sup.len, val_129895->Sup.len);
			TMP389 = addInt((NI32)(TMP388), 2);
			l = addInt(l, (NI32)(TMP389));
		}
		LA4: ;
		nimln(1461, "system.nim");
		res_129937 = addInt(res_129937, 1);
	} LA1: ;
	nimln(395, "osproc.nim");
	nimln(395, "osproc.nim");
	nimln(395, "osproc.nim");
	TMP390 = addInt(l, 2);
	LOC6 = 0;
	LOC6 = alloc0_4616((NI32)(TMP390));
	result = ((NCSTRING) (LOC6));
	nimln(396, "osproc.nim");
	l = 0;
	key_129912 = 0;
	val_129913 = 0;
	h_129940 = 0;
	HEX3Atmp_129942 = 0;
	nimln(40, "strtabs.nim");
	nimln(40, "strtabs.nim");
	HEX3Atmp_129942 = ((*env).Data->Sup.len-1);
	nimln(1458, "system.nim");
	res_129944 = 0;
	nimln(1459, "system.nim");
	while (1) {
		nimln(1459, "system.nim");
		if (!(res_129944 <= HEX3Atmp_129942)) goto LA7;
		nimln(1458, "system.nim");
		h_129940 = res_129944;
		nimln(41, "strtabs.nim");
		{
			NimStringDesc* x;
			NimStringDesc* LOC12;
			NI TMP392;
			NI TMP393;
			nimln(41, "strtabs.nim");
			nimln(41, "strtabs.nim");
			if ((NU)(h_129940) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			if (!!((*env).Data->data[h_129940].Field0 == 0)) goto LA10;
			nimln(42, "strtabs.nim");
			if ((NU)(h_129940) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			key_129912 = (*env).Data->data[h_129940].Field0;
			nimln(42, "strtabs.nim");
			if ((NU)(h_129940) >= (NU)((*env).Data->Sup.len)) raiseIndexError();
			val_129913 = (*env).Data->data[h_129940].Field1;
			nimln(398, "osproc.nim");
			nimln(398, "osproc.nim");
			LOC12 = 0;
			LOC12 = rawNewString(key_129912->Sup.len + val_129913->Sup.len + 1);
appendString(LOC12, key_129912);
appendString(LOC12, ((NimStringDesc*) &TMP391));
appendString(LOC12, val_129913);
			x = LOC12;
			nimln(399, "osproc.nim");
			nimln(399, "osproc.nim");
			nimln(399, "osproc.nim");
			TMP392 = addInt(x->Sup.len, 1);
			memcpy(((void*) (&result[l])), ((void*) (x->data)), (NI32)(TMP392));
			nimln(400, "osproc.nim");
			nimln(400, "osproc.nim");
			nimln(400, "osproc.nim");
			TMP393 = addInt(x->Sup.len, 1);
			l = addInt(l, (NI32)(TMP393));
		}
		LA10: ;
		nimln(1461, "system.nim");
		res_129944 = addInt(res_129944, 1);
	} LA7: ;
	popFrame();
	return result;
}

N_NIMCALL(void, createpipehandles_129948)(NI* rdhandle, NI* wrhandle) {
	tsecurityattributes95862 piinheritablepipe;
	nimfr("createPipeHandles", "osproc.nim")
	memset((void*)&piinheritablepipe, 0, sizeof(piinheritablepipe));
	nimln(411, "osproc.nim");
	nimln(411, "osproc.nim");
	piinheritablepipe.Nlength = ((int) (((NI)sizeof(tsecurityattributes95862))));
	nimln(412, "osproc.nim");
	piinheritablepipe.Lpsecuritydescriptor = NIM_NIL;
	nimln(413, "osproc.nim");
	piinheritablepipe.Binherithandle = ((NI32) 1);
	nimln(414, "osproc.nim");
	{
		NI32 LOC3;
		NI32 LOC6;
		nimln(414, "osproc.nim");
		nimln(414, "osproc.nim");
		LOC3 = 0;
		LOC3 = Dl_96042(rdhandle, wrhandle, &piinheritablepipe, ((NI32) 1024));
		if (!(LOC3 == ((NI32) 0))) goto LA4;
		nimln(415, "osproc.nim");
		nimln(415, "osproc.nim");
		LOC6 = 0;
		LOC6 = oslasterror_104857();
		oserror_104831(LOC6);
	}
	LA4: ;
	popFrame();
}

static N_INLINE(void, fileclose_129962)(NI h) {
	nimfr("fileClose", "osproc.nim")
	nimln(418, "osproc.nim");
	{
		NI32 LOC5;
		nimln(418, "osproc.nim");
		if (!(4 < h)) goto LA3;
		nimln(418, "osproc.nim");
		nimln(418, "osproc.nim");
		LOC5 = 0;
		LOC5 = Dl_96020(h);
	}
	LA3: ;
	popFrame();
}

N_NIMCALL(tprocess128402*, nospstartProcess)(NimStringDesc* command, NimStringDesc* workingdir, NimStringDesc** args, NI argsLen0, tstringtable123810* env, NU8 options) {
	tprocess128402* result;
	tstartupinfo95864 si;
	tprocessinformation95866 procinfo;
	NI success;
	NI hi;
	NI ho;
	NI he;
	NCSTRING cmdl;
	NCSTRING wd;
	NCSTRING e;
	NI16* tmp;
	NI16* ee;
	NI16* wwd;
	NI32 LOC33;
	NI32 lasterror;
	NI32 LOC50;
	nimfr("startProcess", "osproc.nim")
	result = 0;
	memset((void*)&si, 0, sizeof(si));
	memset((void*)&procinfo, 0, sizeof(procinfo));
	success = 0;
	hi = 0;
	ho = 0;
	he = 0;
	nimln(430, "osproc.nim");
	result = (tprocess128402*) newObj((&NTI128404), sizeof(tprocess128402));
	(*result).Sup.m_type = (&NTI128402);
	nimln(431, "osproc.nim");
	nimln(431, "osproc.nim");
	si.Cb = ((int) (((NI)sizeof(tstartupinfo95864))));
	nimln(432, "osproc.nim");
	{
		nimln(432, "osproc.nim");
		nimln(432, "osproc.nim");
		if (!!(((options &(1<<((((NU8) 4))&7)))!=0))) goto LA3;
		nimln(433, "osproc.nim");
		si.Dwflags = ((NI32) 256);
		nimln(434, "osproc.nim");
		createpipehandles_129948(&si.Hstdinput, &hi);
		nimln(435, "osproc.nim");
		createpipehandles_129948(&ho, &si.Hstdoutput);
		nimln(436, "osproc.nim");
		{
			nimln(436, "osproc.nim");
			if (!((options &(1<<((((NU8) 3))&7)))!=0)) goto LA7;
			nimln(437, "osproc.nim");
			si.Hstderror = si.Hstdoutput;
			nimln(438, "osproc.nim");
			he = ho;
		}
		goto LA5;
		LA7: ;
		{
			nimln(440, "osproc.nim");
			createpipehandles_129948(&he, &si.Hstderror);
		}
		LA5: ;
		nimln(441, "osproc.nim");
		(*result).Inhandle = ((int) (hi));
		nimln(442, "osproc.nim");
		(*result).Outhandle = ((int) (ho));
		nimln(443, "osproc.nim");
		(*result).Errhandle = ((int) (he));
	}
	goto LA1;
	LA3: ;
	{
		nimln(445, "osproc.nim");
		si.Hstderror = Dl_96226(((NI32) -12));
		nimln(446, "osproc.nim");
		si.Hstdinput = Dl_96226(((NI32) -10));
		nimln(447, "osproc.nim");
		si.Hstdoutput = Dl_96226(((NI32) -11));
		nimln(448, "osproc.nim");
		(*result).Inhandle = ((int) (si.Hstdinput));
		nimln(449, "osproc.nim");
		(*result).Outhandle = ((int) (si.Hstdoutput));
		nimln(450, "osproc.nim");
		(*result).Errhandle = ((int) (si.Hstderror));
	}
	LA1: ;
	cmdl = 0;
	nimln(453, "osproc.nim");
	{
		nimln(453, "osproc.nim");
		if (!((options &(1<<((((NU8) 2))&7)))!=0)) goto LA13;
		nimln(454, "osproc.nim");
		cmdl = command->data;
		nimln(455, "osproc.nim");
		{
			nimln(455, "osproc.nim");
			nimln(455, "osproc.nim");
			nimln(455, "osproc.nim");
			if (!!((argsLen0 == 0))) goto LA17;
			nimln(455, "osproc.nim");
			failedassertimpl_81621(((NimStringDesc*) &TMP394));
		}
		LA17: ;
	}
	goto LA11;
	LA13: ;
	{
		nimln(457, "osproc.nim");
		cmdl = buildcommandline_129864(command, args, argsLen0);
	}
	LA11: ;
	nimln(458, "osproc.nim");
	wd = NIM_NIL;
	nimln(459, "osproc.nim");
	e = NIM_NIL;
	nimln(460, "osproc.nim");
	{
		nimln(460, "osproc.nim");
		nimln(460, "osproc.nim");
		if (!(0 < workingdir->Sup.len)) goto LA22;
		nimln(460, "osproc.nim");
		wd = workingdir->data;
	}
	LA22: ;
	nimln(461, "osproc.nim");
	{
		nimln(461, "osproc.nim");
		nimln(461, "osproc.nim");
		if (!!((env == NIM_NIL))) goto LA26;
		nimln(461, "osproc.nim");
		e = buildenv_129889(env);
	}
	LA26: ;
	nimln(462, "osproc.nim");
	{
		NimStringDesc* LOC32;
		nimln(462, "osproc.nim");
		if (!((options &(1<<((((NU8) 0))&7)))!=0)) goto LA30;
		nimln(462, "osproc.nim");
		nimln(462, "osproc.nim");
		LOC32 = 0;
		LOC32 = cstrToNimstr(cmdl);
		printf("%s\015\012", (LOC32)->data);
	}
	LA30: ;
	nimln(464, "osproc.nim");
	tmp = newwidecstring_74750(cmdl);
	nimln(465, "osproc.nim");
	ee = newwidecstring_74750(e);
	nimln(466, "osproc.nim");
	wwd = newwidecstring_74750(wd);
	nimln(467, "osproc.nim");
	nimln(467, "osproc.nim");
	LOC33 = 0;
	LOC33 = Dl_96051(NIM_NIL, tmp, NIM_NIL, NIM_NIL, ((NI32) 1), ((NI32) 1056), ee, wwd, &si, &procinfo);
	success = ((NI) (LOC33));
	nimln(473, "osproc.nim");
	lasterror = oslasterror_104857();
	nimln(475, "osproc.nim");
	{
		nimln(475, "osproc.nim");
		nimln(475, "osproc.nim");
		if (!!(((options &(1<<((((NU8) 4))&7)))!=0))) goto LA36;
		nimln(476, "osproc.nim");
		fileclose_129962(si.Hstdinput);
		nimln(477, "osproc.nim");
		fileclose_129962(si.Hstdoutput);
		nimln(478, "osproc.nim");
		{
			nimln(478, "osproc.nim");
			nimln(478, "osproc.nim");
			if (!!(((options &(1<<((((NU8) 3))&7)))!=0))) goto LA40;
			nimln(479, "osproc.nim");
			fileclose_129962(si.Hstderror);
		}
		LA40: ;
	}
	LA36: ;
	nimln(481, "osproc.nim");
	{
		nimln(481, "osproc.nim");
		nimln(481, "osproc.nim");
		if (!!((e == NIM_NIL))) goto LA44;
		nimln(481, "osproc.nim");
		dealloc_4645(((void*) (e)));
	}
	LA44: ;
	nimln(482, "osproc.nim");
	{
		nimln(482, "osproc.nim");
		if (!(success == 0)) goto LA48;
		nimln(482, "osproc.nim");
		oserror_104831(lasterror);
	}
	LA48: ;
	nimln(484, "osproc.nim");
	nimln(484, "osproc.nim");
	LOC50 = 0;
	LOC50 = Dl_96020(procinfo.Hthread);
	nimln(485, "osproc.nim");
	(*result).Fprocesshandle = procinfo.Hprocess;
	nimln(486, "osproc.nim");
	(*result).Id = ((NI) (procinfo.Dwprocessid));
	popFrame();
	return result;
}

N_NIMCALL(void, nospsuspend)(tprocess128402* p) {
	NI32 LOC1;
	nimfr("suspend", "osproc.nim")
	nimln(497, "osproc.nim");
	nimln(497, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_96202((*p).Fprocesshandle);
	popFrame();
}

N_NIMCALL(void, nospresume)(tprocess128402* p) {
	NI32 LOC1;
	nimfr("resume", "osproc.nim")
	nimln(500, "osproc.nim");
	nimln(500, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_96206((*p).Fprocesshandle);
	popFrame();
}

N_NIMCALL(NIM_BOOL, nosprunning)(tprocess128402* p) {
	NIM_BOOL result;
	NI32 x;
	nimfr("running", "osproc.nim")
	result = 0;
	nimln(503, "osproc.nim");
	x = Dl_96210((*p).Fprocesshandle, ((NI32) 50));
	nimln(504, "osproc.nim");
	nimln(504, "osproc.nim");
	nimln(504, "osproc.nim");
	result = (x == ((NI32) 258));
	goto BeforeRet;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(void, nospterminate)(tprocess128402* p) {
	nimfr("terminate", "osproc.nim")
	nimln(507, "osproc.nim");
	{
		NIM_BOOL LOC3;
		NI32 LOC6;
		nimln(507, "osproc.nim");
		LOC3 = 0;
		LOC3 = nosprunning(p);
		if (!LOC3) goto LA4;
		nimln(508, "osproc.nim");
		nimln(508, "osproc.nim");
		LOC6 = 0;
		LOC6 = Dl_96215((*p).Fprocesshandle, 0);
	}
	LA4: ;
	popFrame();
}

N_NIMCALL(NI, nospwaitForExit)(tprocess128402* p, NI timeout) {
	NI result;
	NI32 LOC1;
	NI32 res;
	NI32 LOC2;
	NI32 LOC3;
	nimfr("waitForExit", "osproc.nim")
	result = 0;
	nimln(511, "osproc.nim");
	nimln(511, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_96210((*p).Fprocesshandle, ((NI32) (timeout)));
	res = 0;
	nimln(514, "osproc.nim");
	nimln(514, "osproc.nim");
	LOC2 = 0;
	LOC2 = Dl_96220((*p).Fprocesshandle, &res);
	nimln(515, "osproc.nim");
	result = ((NI) (res));
	nimln(516, "osproc.nim");
	nimln(516, "osproc.nim");
	LOC3 = 0;
	LOC3 = Dl_96020((*p).Fprocesshandle);
	popFrame();
	return result;
}

N_NIMCALL(NI, peekexitcode_128696)(tprocess128402* p) {
	NI result;
	NIM_BOOL b;
	NI32 LOC1;
	nimfr("peekExitCode", "osproc.nim")
	result = 0;
	nimln(519, "osproc.nim");
	nimln(519, "osproc.nim");
	nimln(519, "osproc.nim");
	LOC1 = 0;
	LOC1 = Dl_96210((*p).Fprocesshandle, ((NI32) 50));
	b = (LOC1 == ((NI32) 258));
	nimln(520, "osproc.nim");
	{
		if (!b) goto LA4;
		nimln(520, "osproc.nim");
		result = -1;
	}
	goto LA2;
	LA4: ;
	{
		NI32 res;
		NI32 LOC7;
		res = 0;
		nimln(523, "osproc.nim");
		nimln(523, "osproc.nim");
		LOC7 = 0;
		LOC7 = Dl_96220((*p).Fprocesshandle, &res);
		nimln(524, "osproc.nim");
		nimln(524, "osproc.nim");
		result = ((NI) (res));
		goto BeforeRet;
	}
	LA2: ;
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(tstream126629*, nospinputStream)(tprocess128402* p) {
	tstream126629* result;
	tfilehandlestream129805* LOC1;
	nimfr("inputStream", "osproc.nim")
	result = 0;
	nimln(527, "osproc.nim");
	nimln(527, "osproc.nim");
	LOC1 = 0;
	LOC1 = newfilehandlestream_129843(((NI) ((*p).Inhandle)));
	result = &LOC1->Sup;
	popFrame();
	return result;
}

N_NIMCALL(tstream126629*, nospoutputStream)(tprocess128402* p) {
	tstream126629* result;
	tfilehandlestream129805* LOC1;
	nimfr("outputStream", "osproc.nim")
	result = 0;
	nimln(530, "osproc.nim");
	nimln(530, "osproc.nim");
	LOC1 = 0;
	LOC1 = newfilehandlestream_129843(((NI) ((*p).Outhandle)));
	result = &LOC1->Sup;
	popFrame();
	return result;
}

N_NIMCALL(tstream126629*, nosperrorStream)(tprocess128402* p) {
	tstream126629* result;
	tfilehandlestream129805* LOC1;
	nimfr("errorStream", "osproc.nim")
	result = 0;
	nimln(533, "osproc.nim");
	nimln(533, "osproc.nim");
	LOC1 = 0;
	LOC1 = newfilehandlestream_129843(((NI) ((*p).Errhandle)));
	result = &LOC1->Sup;
	popFrame();
	return result;
}

N_NIMCALL(NI, nospexecCmd)(NimStringDesc* command) {
	NI result;
	tstartupinfo95864 si;
	tprocessinformation95866 procinfo;
	NI process;
	NI32 l;
	NI16* c;
	NI32 res;
	nimfr("execCmd", "osproc.nim")
	result = 0;
	memset((void*)&si, 0, sizeof(si));
	memset((void*)&procinfo, 0, sizeof(procinfo));
	process = 0;
	l = 0;
	nimln(541, "osproc.nim");
	nimln(541, "osproc.nim");
	si.Cb = ((int) (((NI)sizeof(tstartupinfo95864))));
	nimln(542, "osproc.nim");
	si.Hstderror = Dl_96226(((NI32) -12));
	nimln(543, "osproc.nim");
	si.Hstdinput = Dl_96226(((NI32) -10));
	nimln(544, "osproc.nim");
	si.Hstdoutput = Dl_96226(((NI32) -11));
	nimln(546, "osproc.nim");
	c = newwidecstring_74803(command);
	nimln(547, "osproc.nim");
	res = Dl_96051(NIM_NIL, c, NIM_NIL, NIM_NIL, ((NI32) 0), ((NI32) 32), NIM_NIL, NIM_NIL, &si, &procinfo);
	nimln(552, "osproc.nim");
	{
		NI32 LOC5;
		nimln(552, "osproc.nim");
		if (!(res == ((NI32) 0))) goto LA3;
		nimln(553, "osproc.nim");
		nimln(553, "osproc.nim");
		LOC5 = 0;
		LOC5 = oslasterror_104857();
		oserror_104831(LOC5);
	}
	goto LA1;
	LA3: ;
	{
		NI32 LOC7;
		NI32 LOC15;
		nimln(555, "osproc.nim");
		process = procinfo.Hprocess;
		nimln(556, "osproc.nim");
		nimln(556, "osproc.nim");
		LOC7 = 0;
		LOC7 = Dl_96020(procinfo.Hthread);
		nimln(557, "osproc.nim");
		{
			NI32 LOC10;
			NI32 LOC13;
			nimln(557, "osproc.nim");
			nimln(557, "osproc.nim");
			nimln(557, "osproc.nim");
			LOC10 = 0;
			LOC10 = Dl_96210(process, ((NI32) -1));
			if (!!((LOC10 == ((NI32) -1)))) goto LA11;
			nimln(558, "osproc.nim");
			nimln(558, "osproc.nim");
			LOC13 = 0;
			LOC13 = Dl_96220(process, &l);
			nimln(559, "osproc.nim");
			result = ((NI) (l));
		}
		goto LA8;
		LA11: ;
		{
			nimln(561, "osproc.nim");
			result = -1;
		}
		LA8: ;
		nimln(562, "osproc.nim");
		nimln(562, "osproc.nim");
		LOC15 = 0;
		LOC15 = Dl_96020(process);
	}
	LA1: ;
	popFrame();
	return result;
}

N_NIMCALL(NI, select_129721)(TY129403** readfds, NI timeout) {
	NI result;
	twohandlearray97781 rfds;
	NI i_131034;
	NI HEX3Atmp_131095;
	NI TMP396;
	NI res_131097;
	NI32 ret;
	nimfr("select", "osproc.nim")
	result = 0;
	nimln(565, "osproc.nim");
	{
		nimln(565, "osproc.nim");
		nimln(565, "osproc.nim");
		nimln(565, "osproc.nim");
		if (!!(((*readfds)->Sup.len <= 64))) goto LA3;
		nimln(565, "osproc.nim");
		failedassertimpl_81621(((NimStringDesc*) &TMP395));
	}
	LA3: ;
	memset((void*)rfds, 0, sizeof(rfds));
	i_131034 = 0;
	HEX3Atmp_131095 = 0;
	nimln(567, "osproc.nim");
	nimln(567, "osproc.nim");
	nimln(567, "osproc.nim");
	TMP396 = subInt((*readfds)->Sup.len, 1);
	HEX3Atmp_131095 = (NI32)(TMP396);
	nimln(1458, "system.nim");
	res_131097 = 0;
	nimln(1459, "system.nim");
	while (1) {
		nimln(1459, "system.nim");
		if (!(res_131097 <= HEX3Atmp_131095)) goto LA5;
		nimln(1458, "system.nim");
		i_131034 = res_131097;
		nimln(568, "osproc.nim");
		if ((NU)(i_131034) > (NU)(63)) raiseIndexError();
		if ((NU)(i_131034) >= (NU)((*readfds)->Sup.len)) raiseIndexError();
		rfds[(i_131034)- 0] = (*(*readfds)->data[i_131034]).Fprocesshandle;
		nimln(1461, "system.nim");
		res_131097 = addInt(res_131097, 1);
	} LA5: ;
	nimln(570, "osproc.nim");
	nimln(570, "osproc.nim");
	ret = Dl_97786(((NI32) ((*readfds)->Sup.len)), rfds, ((NI32) 0), ((NI32) (timeout)));
	nimln(572, "osproc.nim");
	switch (ret) {
	case ((NI32) 258):
	{
		nimln(574, "osproc.nim");
		nimln(574, "osproc.nim");
		result = 0;
		goto BeforeRet;
	}
	break;
	case ((NI32) -1):
	{
		NI32 LOC8;
		nimln(576, "osproc.nim");
		nimln(576, "osproc.nim");
		LOC8 = 0;
		LOC8 = oslasterror_104857();
		oserror_104831(LOC8);
	}
	break;
	default:
	{
		NI32 i;
		NI32 TMP397;
		nimln(578, "osproc.nim");
		nimln(578, "osproc.nim");
		TMP397 = subInt(ret, ((NI32) 0));
		i = (NI32)(TMP397);
		nimln(579, "osproc.nim");
		del_131052(readfds, ((NI) (i)));
		nimln(580, "osproc.nim");
		nimln(580, "osproc.nim");
		result = 1;
		goto BeforeRet;
	}
	break;
	}
	BeforeRet: ;
	popFrame();
	return result;
}

N_NIMCALL(void, nospclose)(tprocess128402* p) {
	nimfr("close", "osproc.nim")
	popFrame();
}

N_NIMCALL(void, execcmdex_131202)(NimStringDesc* command, NU8 options, TY131208* Result) {
	tprocess128402* p;
	tstream126629* outp;
	NimStringDesc* line;
	nimfr("execCmdEx", "osproc.nim")
	nimln(954, "osproc.nim");
	p = startcmd_128634(command, options);
	nimln(955, "osproc.nim");
	outp = nospoutputStream(p);
	nimln(956, "osproc.nim");
	unsureAsgnRef((void**) &(*Result).Field0, copyString(TMP398.Field0));
	(*Result).Field1 = TMP398.Field1;
	nimln(957, "osproc.nim");
	nimln(957, "osproc.nim");
	line = rawNewString(120);
	nimln(958, "osproc.nim");
	while (1) {
		nimln(959, "osproc.nim");
		{
			NIM_BOOL LOC4;
			nimln(959, "osproc.nim");
			LOC4 = 0;
			LOC4 = readline_127004(outp, &line);
			if (!LOC4) goto LA5;
			nimln(960, "osproc.nim");
			(*Result).Field0 = resizeString((*Result).Field0, line->Sup.len + 0);
appendString((*Result).Field0, line);
			nimln(961, "osproc.nim");
			(*Result).Field0 = resizeString((*Result).Field0, 2);
appendString((*Result).Field0, ((NimStringDesc*) &TMP380));
		}
		goto LA2;
		LA5: ;
		{
			nimln(963, "osproc.nim");
			(*Result).Field1 = peekexitcode_128696(p);
			nimln(964, "osproc.nim");
			{
				nimln(964, "osproc.nim");
				nimln(964, "osproc.nim");
				if (!!(((*Result).Field1 == -1))) goto LA10;
				nimln(964, "osproc.nim");
				goto LA1;
			}
			LA10: ;
		}
		LA2: ;
	} LA1: ;
	nimln(965, "osproc.nim");
	nospclose(p);
	popFrame();
}
N_NOINLINE(void, stdlibosprocInit)(void) {
	nimfr("osproc", "osproc.nim")
	popFrame();
}

N_NOINLINE(void, stdlibosprocDatInit)(void) {
static TNimNode* TMP373[6];
static TNimNode* TMP383[2];
static TNimNode TMP329[10];
NTI128402.size = sizeof(tprocess128402);
NTI128402.kind = 17;
NTI128402.base = (&NTI2409);
NTI128402.flags = 1;
TMP373[0] = &TMP329[1];
TMP329[1].kind = 1;
TMP329[1].offset = offsetof(tprocess128402, Fprocesshandle);
TMP329[1].typ = (&NTI95842);
TMP329[1].name = "fProcessHandle";
TMP373[1] = &TMP329[2];
TMP329[2].kind = 1;
TMP329[2].offset = offsetof(tprocess128402, Inhandle);
TMP329[2].typ = (&NTI10208);
TMP329[2].name = "inHandle";
TMP373[2] = &TMP329[3];
TMP329[3].kind = 1;
TMP329[3].offset = offsetof(tprocess128402, Outhandle);
TMP329[3].typ = (&NTI10208);
TMP329[3].name = "outHandle";
TMP373[3] = &TMP329[4];
TMP329[4].kind = 1;
TMP329[4].offset = offsetof(tprocess128402, Errhandle);
TMP329[4].typ = (&NTI10208);
TMP329[4].name = "errHandle";
TMP373[4] = &TMP329[5];
TMP329[5].kind = 1;
TMP329[5].offset = offsetof(tprocess128402, Id);
TMP329[5].typ = (&NTI95842);
TMP329[5].name = "id";
TMP373[5] = &TMP329[6];
TMP329[6].kind = 1;
TMP329[6].offset = offsetof(tprocess128402, Exitcode);
TMP329[6].typ = (&NTI4409);
TMP329[6].name = "exitCode";
TMP329[0].len = 6; TMP329[0].kind = 2; TMP329[0].sons = &TMP373[0];
NTI128402.node = &TMP329[0];
NTI128404.size = sizeof(tprocess128402*);
NTI128404.kind = 22;
NTI128404.base = (&NTI128402);
NTI128404.marker = TMP374;
NTI129403.size = sizeof(TY129403*);
NTI129403.kind = 24;
NTI129403.base = (&NTI128404);
NTI129403.marker = TMP375;
NTI129805.size = sizeof(tfilehandlestream129805);
NTI129805.kind = 17;
NTI129805.base = (&NTI126629);
NTI129805.flags = 1;
TMP383[0] = &TMP329[8];
TMP329[8].kind = 1;
TMP329[8].offset = offsetof(tfilehandlestream129805, Handle);
TMP329[8].typ = (&NTI95842);
TMP329[8].name = "handle";
TMP383[1] = &TMP329[9];
TMP329[9].kind = 1;
TMP329[9].offset = offsetof(tfilehandlestream129805, Attheend);
TMP329[9].typ = (&NTI134);
TMP329[9].name = "atTheEnd";
TMP329[7].len = 2; TMP329[7].kind = 2; TMP329[7].sons = &TMP383[0];
NTI129805.node = &TMP329[7];
NTI129803.size = sizeof(tfilehandlestream129805*);
NTI129803.kind = 22;
NTI129803.base = (&NTI129805);
NTI129803.marker = TMP386;
}

